<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SimulaEnf - Simulador de Provas para Enfermagem Obstétrica</title>
    <meta name="description" content="Plataforma avançada de simulados para enfermagem obstétrica com questões comentadas, estatísticas detalhadas e acompanhamento de desempenho.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <style>
        @tailwind base;
        @tailwind components;
        @tailwind utilities;

        @layer base {
          :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --primary: 222.2 47.4% 11.2%;
            --primary-foreground: 210 40% 98%;
            --muted: 210 40% 96.1%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --border: 214.3 31.8% 91.4%;
            --radius: 0.5rem;
            --medical-primary: 200 100% 45%;
            --medical-primary-dark: 200 100% 35%;
            --medical-secondary: 160 60% 45%;
            --medical-accent: 45 100% 60%;
            --medical-success: 120 60% 50%;
            --medical-warning: 30 90% 55%;
            --medical-error: 0 85% 60%;
          }
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
        }
        
        .bg-gradient-primary { background-image: linear-gradient(135deg, hsl(var(--medical-primary)), hsl(var(--medical-primary-dark))); }
        .bg-gradient-hero { background-image: linear-gradient(135deg, hsl(var(--medical-primary) / 0.9), hsl(var(--medical-secondary) / 0.8)); }
        .shadow-soft { box-shadow: 0 4px 20px hsl(var(--medical-primary) / 0.1); }
        .shadow-elevated { box-shadow: 0 8px 30px hsl(var(--medical-primary) / 0.15); }
        .shadow-glow { box-shadow: 0 0 30px hsl(var(--medical-primary) / 0.3); }
        
        .text-medical-primary { color: hsl(var(--medical-primary)); }
        .text-medical-accent { color: hsl(var(--medical-accent)); }
        .text-medical-success { color: hsl(var(--medical-success)); }
        .text-medical-warning { color: hsl(var(--medical-warning)); }

        .border-medical-primary { border-color: hsl(var(--medical-primary)); }
        .bg-medical-primary\/10 { background-color: hsl(var(--medical-primary) / 0.1); }
        .bg-medical-success { background-color: hsl(var(--medical-success)); }
        .bg-medical-warning { background-color: hsl(var(--medical-warning)); }
        .bg-medical-error { background-color: hsl(var(--medical-error)); }
        
        .quiz-option.selected { background-color: hsl(var(--medical-primary) / 0.1); border-color: hsl(var(--medical-primary)); }
        .quiz-option.correct { background-color: hsl(var(--medical-success) / 0.1); border-color: hsl(var(--medical-success)); }
        .quiz-option.incorrect { background-color: hsl(var(--medical-error) / 0.1); border-color: hsl(var(--medical-error)); }
        .quiz-option.disabled { opacity: 0.6; cursor: not-allowed; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.8s ease-out forwards; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app-container">
        <!-- Dashboard Screen -->
        <div id="dashboard-screen">
            <header class="bg-white/80 backdrop-blur-sm border-b sticky top-0 z-50">
                <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="p-2 bg-gradient-primary rounded-lg"><i data-lucide="stethoscope" class="w-6 h-6 text-white"></i></div>
                        <div>
                            <h1 class="text-xl font-bold">SimulaEnf</h1>
                            <p class="text-sm text-gray-500">Enfermagem Obstétrica</p>
                        </div>
                    </div>
                </div>
            </header>
            <section class="relative py-20 px-6 overflow-hidden text-center text-white">
                 <div class="absolute inset-0 bg-gradient-hero"></div>
                 <div class="relative max-w-3xl mx-auto">
                    <h1 class="text-5xl md:text-6xl font-bold mb-6 animate-fade-in">Excelência em <span class="text-medical-accent">Enfermagem Obstétrica</span></h1>
                    <p class="text-xl md:text-2xl mb-8 opacity-90">Prepare-se para concursos com nosso simulador completo e personalizado.</p>
                    <button id="start-now-btn" class="bg-white text-medical-primary hover:bg-white/90 shadow-glow text-lg px-8 py-4 font-semibold rounded-md transition-all duration-300">Começar Agora</button>
                 </div>
            </section>
            
            <section id="progress-section" class="py-12 px-6 bg-gray-50 hidden">
                <div class="max-w-7xl mx-auto">
                    <h2 class="text-3xl font-bold text-center mb-8">Seu Progresso</h2>
                    <div id="stats-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
                </div>
            </section>

            <section id="simulados" class="py-16 px-6">
                <div class="max-w-7xl mx-auto">
                    <h2 class="text-3xl font-bold text-center mb-12">Simulados Disponíveis</h2>
                    <div id="quiz-list-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                </div>
            </section>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden min-h-screen bg-gray-50">
            <!-- This content will be generated by JS -->
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden min-h-screen bg-gray-50 flex items-center justify-center p-6">
            <div id="results-panel" class="w-full max-w-4xl"></div>
        </div>
    </div>

    <script type="text/javascript">
        // --- DATA ---
        const quizzesData = [
            {
                id: 'prova-1',
                title: 'Prova 1 - Fundamentos e Humanização',
                description: 'Questões sobre legislação, humanização e práticas essenciais da enfermagem obstétrica.',
                difficulty: 'medium',
                estimatedTime: 30,
                questions: [
                    { id: 'q1-1', question: "Segundo a Portaria nº 11/2015 do Ministério da Saúde, a atuação da enfermeira obstetra no parto normal inclui:", options: ["Realizar partos de alto risco sem acompanhamento médico.", "Conduzir partos de risco habitual e prestar cuidados no puerpério imediato.", "Apenas assistir o médico em procedimentos invasivos.", "Executar apenas o pré-natal."], answer: 1, explanation: "A enfermeira obstetra é capacitada para conduzir partos de risco habitual (fisiológicos) de forma autônoma e prestar toda a assistência necessária no pós-parto imediato.", category: "Legislação" },
                    { id: 'q1-2', question: "Qual das alternativas descreve corretamente o uso do partograma?", options: ["Ferramenta para registrar evolução do trabalho de parto e facilitar decisões clínicas.", "Documento usado apenas para controle de estoque de medicamentos.", "Registro financeiro de custos hospitalares no parto.", "Formulário usado para triagem de pacientes no pronto-socorro."], answer: 0, explanation: "O partograma é uma representação gráfica da evolução do trabalho de parto, essencial para monitorar a dilatação cervical, as contrações e o bem-estar fetal.", category: "Assistência ao Parto" },
                    { id: 'q1-3', question: "Em um trabalho de parto de risco habitual, é contraindicada de rotina:", options: ["Liberdade de posição da parturiente.", "Dieta líquida leve.", "Episiotomia sistemática.", "Acompanhante durante o parto."], answer: 2, explanation: "A episiotomia realizada de forma rotineira (sistemática) é uma prática proscrita pelas evidências científicas e órgãos de saúde.", category: "Boas Práticas" },
                    { id: 'q1-4', question: "No atendimento humanizado, a presença do acompanhante é garantida por lei:", options: ["Apenas no pré-natal.", "Apenas no parto normal.", "Durante todo o trabalho de parto, parto e pós-parto imediato.", "Apenas em caso de parto de risco habitual."], answer: 2, explanation: "A Lei nº 11.108/2005, conhecida como a Lei do Acompanhante, garante à parturiente o direito à presença de um acompanhante de sua escolha durante todo o período de trabalho de parto, parto e pós-parto imediato.", category: "Humanização" },
                    { id: 'q1-5', question: "A Lei do Exercício Profissional de Enfermagem (Lei 7.498/1986) estabelece que enfermeiros podem:", options: ["Realizar prescrição de medicamentos em programas de saúde pública.", "Executar atos cirúrgicos complexos sem supervisão.", "Conduzir partos de alto risco sem médico.", "Somente atuar em função administrativa."], answer: 0, explanation: "A Lei 7.498/86, regulamentada pelo Decreto 94.406/87, permite a prescrição de medicamentos em programas de saúde pública e em rotinas aprovadas pela instituição de saúde.", category: "Legislação" },
                    { id: 'q1-6', question: "Sobre analgesia não farmacológica, assinale a correta:", options: ["Banho morno e bola de pilates podem reduzir dor e ansiedade.", "Massagem lombar é contraindicada em qualquer fase do trabalho de parto.", "Musicoterapia aumenta o risco de taquicardia fetal.", "Apenas medicamentos controlam a dor do parto."], answer: 0, explanation: "Métodos não farmacológicos como banho, massagens e liberdade de posição são altamente eficazes para o alívio da dor e da ansiedade.", category: "Humanização" },
                    { id: 'q1-7', question: "A Política Nacional de Atenção à Saúde da Mulher (2004) deve atingir as mulheres em todos os ciclos de vida, incluindo grupos populacionais como:", options: ["Apenas mulheres em idade reprodutiva de áreas urbanas.", "Apenas mulheres com plano de saúde privado.", "Mulheres negras, indígenas, rurais, presidiárias, com deficiência, entre outras.", "Apenas mulheres heterossexuais e casadas."], answer: 2, explanation: "A política visa à integralidade e equidade, abrangendo a diversidade da população feminina, incluindo recortes de raça/etnia, local de moradia, situação de privação de liberdade e orientação sexual.", category: "Legislação" },
                    { id: 'q1-8', question: "De acordo com o Código de Ética de Enfermagem, é dever do profissional em situações de morte e pós-morte:", options: ["Preencher o registro de óbito, mesmo que não seja sua atribuição legal.", "Utilizar mídias sociais para dar conforto aos familiares, com consentimento.", "Respeitar o pudor, a privacidade e a intimidade da pessoa e de sua família.", "Recusar-se a preparar o corpo, alegando objeção de consciência."], answer: 2, explanation: "O respeito à dignidade da pessoa se estende ao período pós-morte, sendo um dever ético fundamental do profissional de enfermagem.", category: "Ética Profissional" },
                    { id: 'q1-9', question: "Acolhimento e Classificação de Risco nas maternidades, segundo o Ministério da Saúde, baseia-se em:", options: ["Atendimento por ordem de chegada para garantir a isonomia.", "Avaliação da gravidade clínica por um profissional de nível médio.", "Priorização do atendimento por convênio médico.", "Atendimento em tempo oportuno, de acordo com a gravidade clínica, abandonando a lógica da ordem de chegada."], answer: 3, explanation: "A classificação de risco visa priorizar o atendimento de gestantes com quadros mais graves, otimizando o cuidado e reduzindo a morbimortalidade.", category: "Gestão em Saúde" },
                    { id: 'q1-10', question: "O Teste do Pezinho, parte da Triagem Neonatal Biológica (TNB), deve ser coletado idealmente entre:", options: ["O 1º e o 2º dia de vida.", "O 3º e o 5º dia de vida.", "O 7º e o 10º dia de vida.", "O 10º e o 15º dia de vida."], answer: 1, explanation: "Este período é ideal para a detecção precoce de diversas doenças metabólicas, genéticas e infecciosas, permitindo o tratamento antes do aparecimento de sintomas graves.", category: "Neonatologia" },
                ]
            },
            {
                id: 'prova-2',
                title: 'Prova 2 - Emergências e Neonatologia',
                description: 'Foco em situações críticas, monitorização fetal e cuidados com o recém-nascido.',
                difficulty: 'hard',
                estimatedTime: 30,
                questions: [
                    { id: 'q2-1', question: "Sinal clássico de descolamento prematuro de placenta:", options: ["Sangramento vaginal escuro e dor abdominal intensa.", "Sangramento claro e indolor.", "Contrações irregulares e indolores.", "Aumento súbito de movimentos fetais."], answer: 0, explanation: "O descolamento prematuro de placenta (DPP) é uma emergência obstétrica caracterizada por sangramento de cor escura, dor abdominal súbita e intensa, e hipertonia uterina.", category: "Emergências Obstétricas" },
                    { id: 'q2-2', question: "Em casos de eclâmpsia, a droga de escolha para prevenção de convulsões é:", options: ["Diazepam.", "Sulfato de magnésio.", "Metildopa.", "Oxitocina."], answer: 1, explanation: "O sulfato de magnésio é o medicamento de primeira escolha para a prevenção e tratamento das convulsões na pré-eclâmpsia grave e na eclâmpsia.", category: "Farmacologia" },
                    { id: 'q2-3', question: "Durante um parto, a cardiotocografia mostra desacelerações tardias repetidas. Isso indica:", options: ["Compressão de cordão", "Hipóxia fetal", "Traçado normal", "Variabilidade normal"], answer: 1, explanation: "Desacelerações tardias (DIP II) são um sinal ominoso que indica insuficiência uteroplacentária, levando à hipóxia fetal.", category: "Monitorização Fetal" },
                    { id: 'q2-4', question: "Na reanimação neonatal, após 30s de VPP, o bebê está com FC de 50 bpm. Qual o próximo passo?", options: ["Continuar apenas VPP", "Iniciar massagem cardíaca coordenada com VPP", "Administrar oxigênio inalatório", "Suspender e observar"], answer: 1, explanation: "Frequência < 60 bpm após VPP eficaz indica necessidade de iniciar compressões torácicas coordenadas com a ventilação.", category: "Neonatologia" },
                    { id: 'q2-5', question: "No escore de Apgar, qual dos sinais abaixo avalia o tônus muscular?", options: ["Frequência cardíaca", "Esforço respiratório", "Flexão ativa dos membros", "Cor da pele"], answer: 2, explanation: "No Apgar, o 'A' de Atividade (tônus muscular) é avaliado pela movimentação e flexão dos membros.", category: "Neonatologia" },
                    { id: 'q2-6', question: "Hemólise, elevação de enzimas hepáticas e trombocitopenia (plaquetas < 100.000/mm³) são sinais associados a qual distúrbio hipertensivo?", options: ["Eclâmpsia", "Pré-eclâmpsia sobreposta", "Síndrome HELLP", "Hipertensão crônica"], answer: 2, explanation: "A Síndrome HELLP (Hemolysis, Elevated Liver enzymes, Low Platelets) é uma complicação grave da pré-eclâmpsia, caracterizada por esses achados laboratoriais.", category: "Emergências Obstétricas" },
                    { id: 'q2-7', question: "A profilaxia da conjuntivite gonocócica em recém-nascidos com colírio antibiótico deve ser realizada em até:", options: ["30 minutos após o nascimento", "1 hora após o nascimento", "4 horas após o nascimento", "12 horas após o nascimento"], answer: 1, explanation: "A profilaxia da oftalmia neonatal deve ser realizada na primeira hora após o nascimento, como parte dos cuidados imediatos ao recém-nascido, para máxima eficácia.", category: "Neonatologia" },
                    { id: 'q2-8', question: "Qual é a indicação absoluta para a realização de uma cesariana?", options: ["Feto não reativo em trabalho de parto", "Gestante com HIV e baixa carga viral", "Situação fetal transversa", "Apresentação pélvica em primigesta"], answer: 2, explanation: "A situação fetal transversa (quando o feto está atravessado no útero) impossibilita o parto vaginal, sendo uma indicação absoluta para cesariana.", category: "Procedimentos Cirúrgicos" },
                    { id: 'q2-9', question: "Qual dos seguintes é um fator de risco antenatal associado a maior necessidade de reanimação neonatal?", options: ["Idade materna entre 20 e 30 anos", "Gestação a termo", "Ausência de cuidado pré-natal", "Parto vaginal espontâneo"], answer: 2, explanation: "A ausência de cuidado pré-natal é um importante fator de risco, pois impede a identificação e o manejo de diversas condições que podem afetar o bem-estar fetal.", category: "Neonatologia" },
                    { id: 'q2-10', question: "A distócia de ombros ocorre pela impactação do diâmetro bisacromial fetal entre:", options: ["As espinhas isquiáticas", "O púbis e o promontório sacral maternos", "O cóccix e o púbis", "As tuberosidades isquiáticas"], answer: 1, explanation: "A distócia de ombro é a impactação do ombro anterior fetal contra a sínfise púbica materna após a saída da cabeça.", category: "Emergências Obstétricas" },
                ]
            },
            {
                id: 'prova-3',
                title: 'Prova 3 - Assistência ao Parto e Pré-Natal',
                description: 'Questões sobre o manejo do parto, analgesia e cuidados com o recém-nascido.',
                difficulty: 'medium',
                estimatedTime: 30,
                questions: [
                    { id: 'q4-1', question: "No manejo do terceiro período do parto, a conduta ativa inclui:", options: ["Administração de uterotônico, tração controlada do cordão e massagem uterina.", "Esperar a placenta se desprender espontaneamente.", "Realizar episiotomia de rotina.", "Realizar curetagem uterina."], answer: 0, explanation: "A conduta ativa do terceiro período visa reduzir a hemorragia pós-parto e seus pilares são o uso de uterotônico, a tração controlada do cordão e a massagem uterina.", category: "Assistência ao Parto" },
                    { id: 'q4-2', question: "RN de 3,2 kg, prescrição: vitamina K1 1 mg. Ampola: 10 mg/1 mL. Calcule o volume.", options: ["0.1 mL", "0.32 mL", "0.032 mL", "1 mL"], answer: 0, explanation: "A dose prescrita é de 1 mg (independente do peso, neste caso). Se a ampola tem 10mg/mL, para 1mg, usa-se regra de três: 10mg -- 1mL / 1mg -- X => 10X=1 => X=0,1mL.", category: "Neonatologia" },
                    { id: 'q4-3', question: "Uma gestante está com 34 semanas. O que é esperado no padrão respiratório do feto?", options: ["Respiração regular e constante", "Movimentos respiratórios irregulares e intermitentes", "Ausência completa de movimentos respiratórios", "Respiração forçada e profunda"], answer: 1, explanation: "Nessa fase, o feto 'treina' os músculos respiratórios, mas os movimentos são irregulares e intermitentes, não contínuos.", category: "Fisiologia Fetal" },
                    { id: 'q4-4', question: "Qual o cuidado essencial na administração de ocitocina?", options: ["Aumentar a dose rapidamente", "Monitorar contrações e FCF continuamente", "Administrar em bolus", "Manter jejum absoluto"], answer: 1, explanation: "O cuidado mais crítico é a monitorização contínua da dinâmica uterina (para evitar taquissistolia) e da frequência cardíaca fetal (FCF) para garantir a segurança.", category: "Assistência ao Parto" },
                    { id: 'q4-5', question: "A palpação obstétrica que delimita o fundo do útero e identifica o polo fetal que o ocupa é o:", options: ["Primeiro tempo da Manobra de Leopold", "Segundo tempo da Manobra de Leopold", "Terceiro tempo da Manobra de Leopold", "Quarto tempo da Manobra de Leopold"], answer: 0, explanation: "O primeiro tempo da Manobra de Leopold consiste em delimitar o fundo uterino com ambas as mãos para identificar qual polo fetal (cefálico ou pélvico) está presente.", category: "Semiologia Obstétrica" },
                    { id: 'q4-6', question: "Para o rastreamento de Diabetes Mellitus Gestacional, o Teste Oral de Tolerância à Glicose (TOTG 75g) deve ser realizado preferencialmente entre:", options: ["16 e 20 semanas", "20 e 24 semanas", "24 e 28 semanas", "28 e 32 semanas"], answer: 2, explanation: "A recomendação padrão do Ministério da Saúde e outras entidades é a realização do TOTG entre a 24ª e a 28ª semana de gestação.", category: "Pré-Natal" },
                    { id: 'q4-7', question: "A aplicação de compressas mornas no períneo durante o segundo estágio do parto é uma prática:", options: ["Contraindicada por aumentar o risco de laceração.", "Recomendada para aliviar a dor e reduzir o risco de lacerações graves.", "Ineficaz e deve ser eliminada.", "Indicada apenas para multíparas."], answer: 1, explanation: "As evidências científicas mostram que compressas mornas no períneo são uma prática benéfica, associada a maior conforto e menor trauma perineal.", category: "Boas Práticas" },
                    { id: 'q4-8', question: "Após um parto vaginal sem complicações, mães e recém-nascidos saudáveis devem ter alta hospitalar, no mínimo, após:", options: ["6 horas", "12 horas", "24 horas", "48 horas"], answer: 2, explanation: "A OMS e o Ministério da Saúde recomendam um período mínimo de 24 horas de internação para monitorar o bem-estar do binômio mãe-bebê e orientar sobre amamentação e cuidados.", category: "Puerpério" },
                    { id: 'q4-9', question: "A amniotomia (ruptura artificial da bolsa) deve ser realizada de forma rotineira no trabalho de parto?", options: ["Sim, para acelerar a dilatação em todos os casos.", "Sim, mas apenas em multíparas.", "Não, seu uso rotineiro não é recomendado e deve ser reservado para casos específicos.", "Não, é uma prática proscrita em qualquer situação."], answer: 2, explanation: "O uso rotineiro da amniotomia não demonstrou benefícios consistentes e pode aumentar o risco de infecção, devendo ser uma decisão clínica baseada na avaliação individual.", category: "Assistência ao Parto" },
                    { id: 'q4-10', question: "Qual a recomendação para a visita domiciliar ao binômio mãe-bebê após a alta?", options: ["No 1º mês após a alta.", "Na 2ª semana após a alta.", "Na 1ª semana após a alta.", "Apenas se houver intercorrências."], answer: 2, explanation: "O Ministério da Saúde recomenda que a visita domiciliar pela equipe de atenção primária ocorra na primeira semana após a alta para avaliar a amamentação, a saúde da puérpera e do recém-nascido.", category: "Puerpério" },
                ]
            },
            {
                id: 'prova-4',
                title: 'Prova 4 - Simulado Geral (Concurso)',
                description: 'Um simulado abrangente com 10 questões de temas variados para testar seu conhecimento.',
                difficulty: 'hard',
                estimatedTime: 30,
                questions: [
                    { id: 'q5-1', question: "A Data Provável do Parto (DPP) pela regra de Näegele, para uma DUM em 15/11/2024, é:", options: ["22/08/2025", "22/08/2024", "15/08/2025", "07/08/2025"], answer: 0, explanation: "Regra de Näegele: DUM + 7 dias - 3 meses + 1 ano. 15/11/2024 -> 22/11/2024 -> 22/08/2024 -> 22/08/2025.", category: "Pré-Natal" },
                    { id: 'q5-2', question: "Uma paciente precisa receber penicilina cristalina 5 milhões UI. Cada frasco contém 1 milhão UI. Quantos frascos serão usados?", options: ["2 frascos", "4 frascos", "5 frascos", "10 frascos"], answer: 2, explanation: "Cálculo simples de divisão: 5.000.000 UI (dose prescrita) / 1.000.000 UI (por frasco) = 5 frascos.", category: "Cálculos" },
                    { id: 'q5-3', question: "A droga de escolha para prevenção de convulsões na eclâmpsia é:", options: ["Diazepam", "Sulfato de magnésio", "Hidralazina", "Nifedipina"], answer: 1, explanation: "O Sulfato de Magnésio é o anticonvulsivante de escolha na eclâmpsia.", category: "Farmacologia" },
                    { id: 'q5-4', question: "No manejo do terceiro período do parto, a conduta ativa inclui:", options: ["Administração de uterotônico, tração controlada do cordão e massagem uterina.", "Esperar a placenta se desprender espontaneamente.", "Realizar episiotomia.", "Realizar curetagem uterina."], answer: 0, explanation: "A conduta ativa do terceiro período visa reduzir a hemorragia pós-parto.", category: "Assistência ao Parto" },
                    { id: 'q5-5', question: "Um RN de 3,5 kg deve receber vitamina K na dose de 1 mg/kg. O frasco contém 10 mg/mL. Calcule o volume.", options: ["0.35 mL", "0.5 mL", "3.5 mL", "1.0 mL"], answer: 0, explanation: "Dose: 1 mg/kg * 3,5 kg = 3,5 mg. Volume: 3,5 mg / 10 mg/mL = 0,35 mL.", category: "Cálculos" },
                    { id: 'q5-6', question: "A Lei do Acompanhante (Lei 11.108/2005) garante a presença de um acompanhante durante:", options: ["Apenas em partos normais.", "Todo o trabalho de parto, parto e pós-parto imediato.", "Apenas no momento do nascimento.", "Apenas em maternidades públicas."], answer: 1, explanation: "A lei garante o direito durante todo o processo: trabalho de parto, parto e pós-parto imediato.", category: "Legislação" },
                    { id: 'q5-7', question: "Administrar 500 mL em 3 horas, equipo macro (20 gotas/mL). Calcule a taxa em gotas/min.", options: ["28 gotas/min", "56 gotas/min", "83 gotas/min", "167 gotas/min"], answer: 1, explanation: "Fórmula: (Volume * 20) / (Tempo em min) = (500 * 20) / 180 ≈ 55,5. Arredondando, 56 gotas/min.", category: "Cálculos" },
                    { id: 'q5-8', question: "No escore de Apgar, qual dos sinais abaixo avalia o tônus muscular?", options: ["Frequência cardíaca", "Esforço respiratório", "Flexão ativa dos membros", "Cor da pele"], answer: 2, explanation: "No Apgar, o 'A' de Atividade (tônus muscular) é avaliado pela movimentação e flexão dos membros.", category: "Neonatologia" },
                    { id: 'q5-9', question: "Desacelerações tardias repetidas na cardiotocografia indicam:", options: ["Compressão de cordão", "Hipóxia fetal", "Bem-estar fetal", "Parto iminente"], answer: 1, explanation: "Desacelerações tardias são um sinal de alerta para insuficiência placentária e possível hipóxia fetal.", category: "Monitorização Fetal" },
                    { id: 'q5-10', question: "Prescrição: administrar 2 g de ampicilina. Frasco-ampola contém 1 g de pó e deve ser diluído com 5 mL de diluente (solução final = 1 g/5 mL). Qual o volume total a ser administrado?", options: ["5 mL", "7.5 mL", "10 mL", "20 mL"], answer: 2, explanation: "Se cada frasco de 1 g resulta em 5 mL, para administrar 2 g são necessários dois frascos. Volume total = 2 * 5 mL = 10 mL.", category: "Cálculos" }
                ]
            },
            {
                id: 'prova-5',
                title: 'Prova 5 - Tópicos Avançados (Concurso)',
                description: 'Questões técnicas extraídas de concursos e residências para um desafio maior.',
                difficulty: 'hard',
                estimatedTime: 35,
                questions: [
                    { id: 'q6-1', question: "A palpação obstétrica para identificar apresentação, posição e situação fetal é conhecida como:", options: ["Manobra de McRoberts", "Manobra de Leopold-Zweifel", "Manobra de Jacob Dublin", "Manobra de Gaskin"], answer: 1, explanation: "A sequência de quatro palpações abdominais para determinar a estática fetal é chamada de Manobra de Leopold-Zweifel.", category: "Semiologia Obstétrica" },
                    { id: 'q6-2', question: "Uma gestante com 26 semanas, sem vacinas prévias, deve receber qual esquema vacinal para dT/dTpa?", options: ["Apenas 1 dose de dTpa", "2 doses de dT e 1 de dTpa", "3 doses de dT", "1 dose de dT e 1 de dTpa"], answer: 1, explanation: "Para gestante não vacinada, o esquema é de 2 doses de dT com intervalo de 30 a 60 dias, e uma dose de dTpa a partir da 20ª semana.", category: "Imunização" },
                    { id: 'q6-3', question: "A distócia de ombros ocorre pela impactação do diâmetro bisacromial fetal entre:", options: ["As espinhas isquiáticas", "O púbis e o promontório sacral maternos", "O cóccix e o púbis", "As tuberosidades isquiáticas"], answer: 1, explanation: "A distócia de ombro é a impactação do ombro anterior fetal contra a sínfise púbica materna após a saída da cabeça.", category: "Emergências Obstétricas" },
                    { id: 'q6-4', question: "Qual dos seguintes agentes tocolíticos é utilizado para inibir o trabalho de parto prematuro?", options: ["Metildopa", "Ocitocina", "Nifedipina", "Misoprostol"], answer: 2, explanation: "A Nifedipina, um bloqueador do canal de cálcio, é um dos agentes tocolíticos utilizados para relaxar o útero e inibir contrações prematuras.", category: "Farmacologia" },
                    { id: 'q6-5', question: "Qual é a principal causa de morte materna no Brasil?", options: ["Hemorragia", "Infecção puerperal", "Doenças hipertensivas", "Abortamento"], answer: 2, explanation: "As síndromes hipertensivas, incluindo pré-eclâmpsia e eclâmpsia, são a principal causa de mortalidade materna direta no Brasil.", category: "Epidemiologia" },
                    { id: 'q6-6', question: "A profilaxia da conjuntivite gonocócica em recém-nascidos com colírio antibiótico deve ser realizada em até:", options: ["30 minutos após o nascimento", "1 hora após o nascimento", "2 horas após o nascimento", "24 horas após o nascimento"], answer: 1, explanation: "A profilaxia da oftalmia neonatal deve ser realizada na primeira hora após o nascimento, como parte dos cuidados imediatos ao recém-nascido.", category: "Neonatologia" },
                    { id: 'q6-7', question: "Em uma gestante com diagnóstico de hipertensão gestacional, qual achado laboratorial NÃO é esperado?", options: ["Proteinúria ausente ou < 300mg/24h", "Níveis normais de plaquetas", "Aumento de enzimas hepáticas", "Níveis normais de ácido úrico"], answer: 2, explanation: "O aumento de enzimas hepáticas não é característico da hipertensão gestacional isolada, mas sim de complicações como a pré-eclâmpsia grave ou a síndrome HELLP.", category: "Hipertensão Gestacional" },
                    { id: 'q6-8', question: "O uso de trastuzumabe durante a gravidez é contraindicado, pois pode provocar:", options: ["Macrossomia fetal", "Polidrâmnio", "Oligoidrâmnio", "Restrição de crescimento intrauterino"], answer: 2, explanation: "O trastuzumabe, usado no tratamento de alguns tipos de câncer, está associado a um risco significativo de oligoidrâmnio (baixo volume de líquido amniótico) e disfunção renal fetal.", category: "Farmacologia" },
                    { id: 'q6-9', question: "Qual o período recomendado para clampeamento do cordão umbilical em recém-nascidos a termo com boa vitalidade?", options: ["Imediatamente após o nascimento", "Entre 1 a 3 minutos após o nascimento", "Após 5 minutos do nascimento", "Apenas após a dequitação da placenta"], answer: 1, explanation: "O clampeamento tardio ou oportuno do cordão (entre 1 a 3 minutos) é recomendado pela OMS e SBP por seus benefícios, como aumento das reservas de ferro do bebê.", category: "Boas Práticas" },
                    { id: 'q6-10', question: "A administração de imunoglobulina anti-D em mulheres Rh-negativo não sensibilizadas é indicada em qual situação?", options: ["Após o parto de um recém-nascido Rh-negativo", "Após o parto de um recém-nascido Rh-positivo", "Apenas se houver hemorragia pós-parto", "Apenas em gestantes primigestas"], answer: 1, explanation: "A imunoglobulina anti-D previne a sensibilização materna (produção de anticorpos) que pode ocorrer quando uma mãe Rh-negativo gera um bebê Rh-positivo.", category: "Imunoprofilaxia" },
                ]
            },
             {
                id: 'prova-7',
                title: 'Prova 7 - Foco em Cálculos',
                description: 'Uma prova inteiramente dedicada a cálculos de gotejamento, diluição e dosagens em obstetrícia.',
                difficulty: 'hard',
                estimatedTime: 40,
                questions: [
                    { id: 'q7-1', question: "Prescrição: Ocitocina 5 UI em 500 mL de SG 5%, a 30 mL/h. Calcule a dose em UI/h.", options: ["0.2 UI/h", "0.3 UI/h", "0.5 UI/h", "1.0 UI/h"], answer: 1, explanation: "Concentração: 5 UI / 500 mL = 0.01 UI/mL. Dose por hora: 0.01 UI/mL * 30 mL/h = 0.3 UI/h.", category: "Cálculos" },
                    { id: 'q7-2', question: "Puérpera necessita de Ampicilina 1g IV. Frasco contém 2g de pó, diluído em 10 mL de AD. Quantos mL aspirar?", options: ["2.5 mL", "5 mL", "7.5 mL", "10 mL"], answer: 1, explanation: "Se 2g estão em 10mL, então 1g estará na metade do volume, ou seja, 5 mL.", category: "Cálculos" },
                    { id: 'q7-3', question: "Vitamina K para um RN de 3,5 kg, na dose de 1 mg/kg. Ampola contém 10 mg/mL. Calcule o volume.", options: ["0.35 mL", "0.5 mL", "1 mL", "3.5 mL"], answer: 0, explanation: "Dose total: 1 mg/kg * 3,5 kg = 3,5 mg. Volume: 3,5 mg / 10 mg/mL = 0,35 mL.", category: "Cálculos" },
                    { id: 'q7-4', question: "Sulfato de Magnésio 4g IV diluído em 100 mL para infundir em 20 minutos. Equipo macro (20 gotas/mL). Calcule o gotejamento.", options: ["50 gotas/min", "75 gotas/min", "100 gotas/min", "120 gotas/min"], answer: 2, explanation: "Fórmula: (100 mL * 20 gotas/mL) / 20 min = 2000 / 20 = 100 gotas/min.", category: "Cálculos" },
                    { id: 'q7-5', question: "Prescrição de Penicilina G Cristalina 5 milhões UI. Cada frasco contém 1 milhão UI. Quantos frascos são necessários?", options: ["3 frascos", "4 frascos", "5 frascos", "6 frascos"], answer: 2, explanation: "Cálculo: 5.000.000 UI (prescrito) / 1.000.000 UI (por frasco) = 5 frascos.", category: "Cálculos" },
                    { id: 'q7-6', question: "Hidralazina 5 mg IV. Ampola: 20 mg/2 mL. Calcule o volume a ser administrado.", options: ["0.25 mL", "0.5 mL", "0.75 mL", "1.0 mL"], answer: 1, explanation: "Concentração: 20 mg / 2 mL = 10 mg/mL. Volume: 5 mg / 10 mg/mL = 0,5 mL.", category: "Cálculos" },
                    { id: 'q7-7', question: "Ampicilina 2g a cada 6h. Frascos disponíveis de 500 mg. Quantos frascos por dose?", options: ["2 frascos", "3 frascos", "4 frascos", "5 frascos"], answer: 2, explanation: "Dose prescrita: 2g = 2000mg. Cálculo: 2000mg / 500mg/frasco = 4 frascos.", category: "Cálculos" },
                    { id: 'q7-8', question: "Ocitocina 10 UI em 500 mL de SF 0,9%, com infusão de 40 mL/h. Quantas UI/h a paciente receberá?", options: ["0.4 UI/h", "0.6 UI/h", "0.8 UI/h", "1.2 UI/h"], answer: 2, explanation: "Concentração: 10 UI / 500 mL = 0.02 UI/mL. Dose: 0.02 UI/mL * 40 mL/h = 0.8 UI/h.", category: "Cálculos" },
                    { id: 'q7-9', question: "RN de 3,2 kg deve receber Vitamina K na dose de 1 mg/kg. O frasco contém 10 mg/mL. Calcule o volume.", options: ["0.16 mL", "0.32 mL", "0.64 mL", "1.0 mL"], answer: 1, explanation: "Dose: 1 mg/kg * 3,2 kg = 3,2 mg. Volume: 3,2 mg / 10 mg/mL = 0,32 mL.", category: "Cálculos" },
                    { id: 'q7-10', question: "Sulfato de magnésio 4 g IV diluídos em 100 mL devem correr em 30 minutos. Calcule o gotejamento (gotas/min) em equipo macro (20 gotas/mL).", options: ["33 gotas/min", "50 gotas/min", "67 gotas/min", "100 gotas/min"], answer: 2, explanation: "Fórmula: (100 mL * 20 gotas/mL) / 30 min = 2000 / 30 = 66,6... Arredondando, 67 gotas/min.", category: "Cálculos" },
                ]
            },
        ];

        // --- GLOBAL STATE ---
        let currentQuiz = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let timerInterval = null;
        let timeElapsed = 0;
        let lastResult = null;
        
        // --- DOM ELEMENTS ---
        const dashboardScreen = document.getElementById('dashboard-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const quizListContainer = document.getElementById('quiz-list-container');
        const statsGrid = document.getElementById('stats-grid');
        const progressSection = document.getElementById('progress-section');

        // --- FUNCTIONS ---
        const showScreen = (screen) => {
            dashboardScreen.classList.add('hidden');
            quizScreen.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            screen.classList.remove('hidden');
        };

        const getProgress = () => {
            try {
                const saved = localStorage.getItem('quizProgress');
                return saved ? JSON.parse(saved) : { attempts: {} };
            } catch {
                return { attempts: {} };
            }
        };

        const saveProgress = (progress) => {
            localStorage.setItem('quizProgress', JSON.stringify(progress));
        };

        const updateProgress = (result) => {
            const progress = getProgress();
            const { quizId, percentage } = result;
            const current = progress.attempts[quizId] || { completed: false, bestScore: 0, attempts: 0 };
            progress.attempts[quizId] = {
                completed: true,
                bestScore: Math.max(current.bestScore || 0, percentage),
                attempts: (current.attempts || 0) + 1,
            };
            saveProgress(progress);
        };

        const renderDashboard = () => {
            const progress = getProgress();
            const allAttempts = Object.values(progress.attempts);
            
            if (allAttempts.length > 0) {
                const totalQuizzes = allAttempts.length;
                const completedQuizzes = allAttempts.filter(p => p.completed).length;
                const allScores = allAttempts.map(p => p.bestScore).filter(s => s > 0);
                const averageScore = allScores.length > 0 ? Math.round(allScores.reduce((a, b) => a + b, 0) / allScores.length) : 0;
                
                statsGrid.innerHTML = `
                    <div class="bg-white rounded-lg shadow-soft border p-4 flex items-center gap-4"><div class="p-3 bg-medical-primary/10 rounded-lg"><i data-lucide="book-open" class="w-6 h-6 text-medical-primary"></i></div><div><p class="text-2xl font-bold">${totalQuizzes}</p><p class="text-sm text-gray-500">Simulados Feitos</p></div></div>
                    <div class="bg-white rounded-lg shadow-soft border p-4 flex items-center gap-4"><div class="p-3 bg-medical-primary/10 rounded-lg"><i data-lucide="trophy" class="w-6 h-6 text-medical-primary"></i></div><div><p class="text-2xl font-bold">${averageScore}%</p><p class="text-sm text-gray-500">Média Geral</p></div></div>
                    <div class="bg-white rounded-lg shadow-soft border p-4 flex items-center gap-4"><div class="p-3 bg-medical-primary/10 rounded-lg"><i data-lucide="target" class="w-6 h-6 text-medical-primary"></i></div><div><p class="text-2xl font-bold">${completedQuizzes}</p><p class="text-sm text-gray-500">Concluídos</p></div></div>
                    <div class="bg-white rounded-lg shadow-soft border p-4 flex items-center gap-4"><div class="p-3 bg-medical-primary/10 rounded-lg"><i data-lucide="flame" class="w-6 h-6 text-medical-primary"></i></div><div><p class="text-2xl font-bold">0</p><p class="text-sm text-gray-500">Sequência</p></div></div>
                `;
                progressSection.classList.remove('hidden');
            }
            
            quizListContainer.innerHTML = quizzesData.map(quiz => {
                const userProgress = progress.attempts[quiz.id];
                const difficultyMap = { easy: 'Fácil', medium: 'Médio', hard: 'Difícil' };
                const difficultyColorMap = { easy: 'bg-medical-success', medium: 'bg-medical-warning', hard: 'bg-medical-error' };

                return `
                    <div class="bg-white rounded-lg shadow-soft border group transition-all duration-300 hover:shadow-elevated hover:-translate-y-1 relative overflow-hidden">
                        <div class="p-6">
                            <div class="flex items-start justify-between mb-2">
                                <span class="inline-block px-2.5 py-0.5 text-xs font-semibold rounded-full ${difficultyColorMap[quiz.difficulty]} text-white">${difficultyMap[quiz.difficulty]}</span>
                                ${userProgress?.completed ? `<div class="flex items-center gap-1 text-medical-success"><i data-lucide="star" class="w-4 h-4 fill-current"></i><span class="text-sm font-medium">${userProgress.bestScore}%</span></div>` : ''}
                            </div>
                            <h3 class="text-xl font-bold text-gray-800 group-hover:text-medical-primary transition-colors">${quiz.title}</h3>
                            <p class="text-gray-500 text-sm mt-1">${quiz.description}</p>
                        </div>
                        <div class="p-6 pt-0">
                            <div class="flex items-center justify-between mb-4 text-sm text-gray-500">
                                <div class="flex items-center gap-1"><i data-lucide="book-open" class="w-4 h-4"></i><span>${quiz.questions.length} questões</span></div>
                                <div class="flex items-center gap-1"><i data-lucide="clock" class="w-4 h-4"></i><span>${quiz.estimatedTime} min</span></div>
                            </div>
                            <button data-quiz-id="${quiz.id}" class="start-quiz-btn w-full bg-gradient-primary text-white font-semibold py-3 rounded-md shadow-soft hover:shadow-glow transition-all duration-300">
                                ${userProgress?.completed ? 'Refazer' : 'Iniciar'} Simulado
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            lucide.createIcons();
            document.querySelectorAll('.start-quiz-btn').forEach(btn => {
                btn.addEventListener('click', (e) => startQuiz(e.currentTarget.dataset.quizId));
            });
        };

        const startQuiz = (quizId) => {
            currentQuiz = quizzesData.find(q => q.id === quizId);
            if (!currentQuiz) return;
            
            currentQuestionIndex = 0;
            userAnswers = new Array(currentQuiz.questions.length).fill(null);
            timeElapsed = 0;
            
            quizScreen.innerHTML = `
                <header class="bg-white border-b shadow-sm sticky top-0 z-10 p-4">
                    <div class="max-w-4xl mx-auto flex justify-between items-center">
                        <button id="back-to-dashboard-btn-quiz" class="flex items-center gap-2 text-gray-600 hover:text-black font-semibold"><i data-lucide="arrow-left" class="w-4 h-4"></i>Voltar</button>
                        <div class="text-lg font-bold text-center">${currentQuiz.title}</div>
                        <div class="flex items-center gap-2 text-gray-600"><i data-lucide="clock" class="w-5 h-5"></i><span id="timer">0:00</span></div>
                    </div>
                    <div id="progress-bar-container" class="max-w-4xl mx-auto mt-2"></div>
                </header>
                <main id="question-container" class="max-w-4xl mx-auto p-6"></main>
            `;
            document.getElementById('back-to-dashboard-btn-quiz').addEventListener('click', () => {
                clearInterval(timerInterval);
                showScreen(dashboardScreen);
                renderDashboard();
            });

            renderQuestion();
            startTimer();
            showScreen(quizScreen);
        };

        const renderQuestion = () => {
            const question = currentQuiz.questions[currentQuestionIndex];
            const progress = ((currentQuestionIndex + 1) / currentQuiz.questions.length) * 100;
            
            document.getElementById('progress-bar-container').innerHTML = `<div class="h-2 rounded-full overflow-hidden bg-gray-200"><div class="bg-gradient-primary h-full rounded-full transition-all duration-500" style="width: ${progress}%"></div></div>`;
            
            const questionContainer = document.getElementById('question-container');
            questionContainer.innerHTML = `
                <div class="bg-white rounded-lg shadow-soft border animate-fade-in">
                    <div class="p-6">
                        <span class="inline-block px-2.5 py-0.5 text-xs font-semibold rounded-full text-medical-primary border-medical-primary border w-fit mb-3">Questão ${currentQuestionIndex + 1}</span>
                        <h3 class="text-lg leading-relaxed font-bold">${question.question}</h3>
                    </div>
                    <div class="p-6 pt-0 space-y-3">
                        ${question.options.map((option, index) => `
                            <div class="quiz-option flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all duration-200 group ${userAnswers[currentQuestionIndex] === index ? 'selected' : ''}" onclick="selectAnswer(${index})">
                                <div class="flex items-center gap-3 w-full">
                                    <i data-lucide="${userAnswers[currentQuestionIndex] === index ? 'check-circle' : 'circle'}" class="w-5 h-5 ${userAnswers[currentQuestionIndex] === index ? 'text-medical-primary' : 'text-gray-400'}"></i>
                                    <span class="flex-1 text-left">${option}</span>
                                    <span class="text-sm font-semibold opacity-70">${String.fromCharCode(65 + index)}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                <div id="submit-btn-container" class="mt-8 text-center"></div>
            `;
            lucide.createIcons();
        };
        
        const selectAnswer = (optionIndex) => {
            if (userAnswers[currentQuestionIndex] !== null) return;
            
            userAnswers[currentQuestionIndex] = optionIndex;
            renderQuestion();
            
            const isLastQuestion = currentQuestionIndex === currentQuiz.questions.length - 1;
            const allAnswered = userAnswers.filter(a => a !== null).length === currentQuiz.questions.length;

            if (isLastQuestion && allAnswered) {
                 document.getElementById('submit-btn-container').innerHTML = `<button onclick="showResults()" class="bg-gradient-primary text-white text-lg px-8 py-4 font-semibold rounded-md animate-pulse">Finalizar Simulado</button>`;
            }

            setTimeout(() => {
                if (!isLastQuestion) {
                    currentQuestionIndex++;
                    renderQuestion();
                }
            }, 500);
        };

        const showResults = () => {
            clearInterval(timerInterval);
            let score = 0;
            currentQuiz.questions.forEach((q, index) => {
                if (userAnswers[index] === q.answer) score++;
            });
            
            lastResult = {
                quizId: currentQuiz.id,
                score,
                totalQuestions: currentQuiz.questions.length,
                percentage: Math.round((score / currentQuiz.questions.length) * 100),
                timeSpent: timeElapsed,
                answers: userAnswers,
            };
            
            updateProgress(lastResult);
            renderResults();
            showScreen(resultsScreen);
        };
        
        const renderResults = () => {
            const { percentage, score, totalQuestions, timeSpent } = lastResult;
            const performance = percentage >= 70 ? { label: 'Aprovado', color: 'bg-medical-success' } : { label: 'Revisar', color: 'bg-medical-warning' };
            const mins = Math.floor(timeSpent / 60);
            const secs = String(timeSpent % 60).padStart(2, '0');

            document.getElementById('results-panel').innerHTML = `
                <div class="space-y-6 animate-fade-in">
                    <div class="bg-gradient-hero text-white border-0 shadow-glow text-center rounded-lg">
                        <div class="p-6">
                            <i data-lucide="trophy" class="w-12 h-12 text-medical-accent mx-auto mb-2"></i>
                            <h3 class="text-3xl font-bold">Resultado Final</h3>
                            <div class="flex items-center justify-center gap-4 mt-4">
                                <div class="text-4xl font-bold">${percentage}%</div>
                            </div>
                            <span class="inline-block px-4 py-1 mt-4 text-lg font-semibold rounded-full ${performance.color} text-white">${performance.label}</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                         <div class="bg-white rounded-lg shadow-soft border p-4 flex items-center gap-4"><div class="p-3 bg-medical-primary/10 rounded-lg"><i data-lucide="target" class="w-6 h-6 text-medical-primary"></i></div><div><p class="text-2xl font-bold">${score}</p><p class="text-sm text-gray-500">Acertos</p></div></div>
                         <div class="bg-white rounded-lg shadow-soft border p-4 flex items-center gap-4"><div class="p-3 bg-medical-primary/10 rounded-lg"><i data-lucide="clock" class="w-6 h-6 text-medical-primary"></i></div><div><p class="text-2xl font-bold">${mins}:${secs}</p><p class="text-sm text-gray-500">Tempo Total</p></div></div>
                         <div class="bg-white rounded-lg shadow-soft border p-4 flex items-center gap-4"><div class="p-3 bg-medical-primary/10 rounded-lg"><i data-lucide="book-open" class="w-6 h-6 text-medical-primary"></i></div><div><p class="text-2xl font-bold">${totalQuestions}</p><p class="text-sm text-gray-500">Questões</p></div></div>
                    </div>
                    <div class="flex gap-4">
                        <button onclick="renderReview()" class="flex-1 border-medical-primary text-medical-primary hover:bg-medical-primary hover:text-white border font-semibold py-3 rounded-md transition-colors">Revisar Respostas</button>
                        <button onclick="startQuiz(lastResult.quizId)" class="flex-1 bg-gradient-primary text-white font-semibold py-3 rounded-md flex items-center justify-center gap-2"><i data-lucide="rotate-ccw" class="w-4 h-4"></i>Nova Tentativa</button>
                    </div>
                </div>
            `;
            lucide.createIcons();
        };
        
        const renderReview = () => {
            const quiz = quizzesData.find(q => q.id === lastResult.quizId);
            quizScreen.innerHTML = `
                <header class="bg-white border-b shadow-sm sticky top-0 z-10 p-4">
                    <div class="max-w-4xl mx-auto flex justify-between items-center">
                        <button id="back-to-results-btn" class="flex items-center gap-2 text-gray-600 hover:text-black font-semibold"><i data-lucide="arrow-left" class="w-4 h-4"></i>Voltar</button>
                        <div class="text-lg font-bold">Revisão: ${quiz.title}</div>
                        <div></div>
                    </div>
                </header>
                <main class="max-w-4xl mx-auto p-6 space-y-6">
                    ${quiz.questions.map((q, index) => {
                        const selectedAnswer = lastResult.answers[index];
                        return `
                            <div class="bg-white rounded-lg shadow-soft border">
                                <div class="p-6">
                                    <span class="inline-block px-2.5 py-0.5 text-xs font-semibold rounded-full text-medical-primary border-medical-primary border w-fit mb-3">Questão ${index + 1}</span>
                                    <h3 class="text-lg leading-relaxed font-bold">${q.question}</h3>
                                </div>
                                <div class="p-6 pt-0 space-y-3">
                                    ${q.options.map((option, optIndex) => `
                                        <div class="quiz-option flex items-center p-4 border-2 rounded-lg disabled ${optIndex === q.answer ? 'correct' : (selectedAnswer === optIndex ? 'incorrect' : '')}">
                                            <div class="flex items-center gap-3 w-full">
                                                <i data-lucide="${optIndex === q.answer ? 'check-circle' : (selectedAnswer === optIndex ? 'x-circle' : 'circle')}" class="w-5 h-5"></i>
                                                <span class="flex-1 text-left">${option}</span>
                                            </div>
                                        </div>
                                    `).join('')}
                                    <div class="mt-6 p-4 bg-blue-50 border-l-4 border-medical-primary rounded-r-lg">
                                        <h4 class="font-semibold text-medical-primary mb-2">Explicação:</h4>
                                        <p class="text-sm text-gray-700 leading-relaxed">${q.explanation}</p>
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('')}
                </main>
            `;
            showScreen(quizScreen);
            lucide.createIcons();
            document.getElementById('back-to-results-btn').addEventListener('click', () => {
                renderResults();
                showScreen(resultsScreen);
            });
        };
        
        const startTimer = () => {
            const timerEl = document.getElementById('timer');
            timerInterval = setInterval(() => {
                timeElapsed++;
                const mins = Math.floor(timeElapsed / 60);
                const secs = String(timeElapsed % 60).padStart(2, '0');
                if(timerEl) timerEl.innerText = `${mins}:${secs}`;
            }, 1000);
        };

        // --- EVENT LISTENERS ---
        document.getElementById('start-now-btn').addEventListener('click', () => {
            document.getElementById('simulados').scrollIntoView({ behavior: 'smooth' });
        });
        
        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            renderDashboard();
        });
    </script>
</body>
</html>
